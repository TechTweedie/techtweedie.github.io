<!DOCTYPE html>
<html lang="en">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Query Parameters on HTTP Trigger - Tech Tweedie</title><meta name="description" content="When your flow is triggered via an HTTP request, it might need to behave differently based on the values passed through query parameters. For instance, you may want your flow to process data differently depending on a user ID or a specific action indicated in the URL."><meta property="og:url" content="http://localhost:1313/posts/custom-mailto-from-command-button/">
  <meta property="og:site_name" content="Tech Tweedie">
  <meta property="og:title" content="Query Parameters on HTTP Trigger">
  <meta property="og:description" content="When your flow is triggered via an HTTP request, it might need to behave differently based on the values passed through query parameters. For instance, you may want your flow to process data differently depending on a user ID or a specific action indicated in the URL.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-04-03T19:00:00+01:00">
    <meta property="article:modified_time" content="2024-07-05T19:45:40+08:00">
    <meta property="article:tag" content="HTTP Trigger">
    <meta property="article:tag" content="Automation">
    <meta property="og:image" content="http://localhost:1313/logo.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/logo.png">
  <meta name="twitter:title" content="Query Parameters on HTTP Trigger">
  <meta name="twitter:description" content="When your flow is triggered via an HTTP request, it might need to behave differently based on the values passed through query parameters. For instance, you may want your flow to process data differently depending on a user ID or a specific action indicated in the URL.">
      <meta name="twitter:site" content="@itweedie">
<meta name="application-name" content="Tech Tweedie">
<meta name="apple-mobile-web-app-title" content="Tech Tweedie"><meta name="theme-color" content="#dddddd"><meta name="msapplication-TileColor" content="#dddddd"><link rel="icon" href="/safari-pinned-tab.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#dddddd"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://localhost:1313/posts/custom-mailto-from-command-button/" /><link rel="prev" href="http://localhost:1313/posts/query-parameters-on-http-trigger/" /><link rel="next" href="http://localhost:1313/posts/pfx-certificate-for-free-for-power-pages/" /><link rel="stylesheet" href="/css/page.min.css"><link rel="stylesheet" href="/css/home.min.css"><meta name="google-site-verification" content="SJUxP7HXovdJ6V7D8UPJm1ntx_D-yiuiC5XM70mnHCI" /><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Query Parameters on HTTP Trigger",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/localhost:1313\/posts\/custom-mailto-from-command-button\/"
        },"genre": "posts","keywords": "HTTP Trigger, Automation","wordcount":  591 ,
        "url": "http:\/\/localhost:1313\/posts\/custom-mailto-from-command-button\/","datePublished": "2022-04-03T19:00:00+01:00","dateModified": "2024-07-05T19:45:40+08:00","publisher": {
            "@type": "Organization",
            "name": "itweedie"},"author": {
                "@type": "Person",
                "name": "itweedie"
            },"description": "When your flow is triggered via an HTTP request, it might need to behave differently based on the values passed through query parameters. For instance, you may want your flow to process data differently depending on a user ID or a specific action indicated in the URL."
    }
    </script></head><body data-header-desktop="fixed" data-header-mobile="auto"><script>(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Tech Tweedie"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/logo-01_150x150.png"
        data-srcset="/logo-01_150x150.png, /logo-01_150x150.png 1.5x, /logo-01_150x150.png 2x"
        data-sizes="auto"
        alt="/logo-01_150x150.png"
        title="/logo-01_150x150.png" /><span class="header-title-pre"> </span><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="https://www.youtube.com/channel/UCy1a2QSDVZNDwZf7KbNmoHQ" rel="noopener noreffer" target="_blank"> YouTube Channel </a><a class="menu-item" href="https://mightora.io/" rel="noopener noreffer" target="_blank"> Free Power Platform Tools </a><span class="menu-item delimiter"></span><a class="menu-item" href="/index.xml" title="RSS"><i class="fa-solid fa-rss fa-fw" title="RSS"></i> </a><a href="#" onclick="return false;" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fa-solid fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Tech Tweedie"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/logo-01_150x150.png"
        data-srcset="/logo-01_150x150.png, /logo-01_150x150.png 1.5x, /logo-01_150x150.png 2x"
        data-sizes="auto"
        alt="/logo-01_150x150.png"
        title="/logo-01_150x150.png" /><span class="header-title-pre"> </span><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="https://www.youtube.com/channel/UCy1a2QSDVZNDwZf7KbNmoHQ" title="" rel="noopener noreffer" target="_blank">YouTube Channel</a><a class="menu-item" href="https://mightora.io/" title="" rel="noopener noreffer" target="_blank">Free Power Platform Tools</a><div class="menu-item"><a href="/index.xml" title="RSS"><i class="fa-solid fa-rss fa-fw" title="RSS"></i> </a>
                <span>&nbsp;|&nbsp;</span><a href="#" onclick="return false;" class="theme-switch" title="Switch Theme">
                    <i class="fa-solid fa-adjust fa-fw"></i>
                </a>
            </div></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single" data-toc="disable"><div class="single-card" ><h2 class="single-title animated flipInX">Query Parameters on HTTP Trigger</h2><div class="post-meta">
                <div class="post-meta-line"><span class="post-author"><a href="https://iantweedie.biz" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fa-solid fa-user-circle fa-fw"></i>itweedie</a></span>&nbsp;<span class="post-category">published in <a href="/categories/power-automate/"><i class="fa-regular fa-folder fa-fw"></i>Power Automate</a>&nbsp;<a href="/categories/power-platform/"><i class="fa-regular fa-folder fa-fw"></i>Power Platform</a></span></div>
                <div class="post-meta-line"><span><i class="fa-regular fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2022-04-03">2022-04-03</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw"></i>&nbsp;591 words</span>&nbsp;
                    <span><i class="fa-regular fa-clock fa-fw"></i>&nbsp;3 minutes</span>&nbsp;</div>
            </div>
            
            <hr><div class="details toc" id="toc-static"  data-kept="">
                    <div class="details-summary toc-title">
                        <span>Contents</span>
                        <span><i class="details-icon fa-solid fa-angle-right"></i></span>
                    </div>
                    <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#why-it-matters">Why It Matters</a></li>
    <li><a href="#the-solution">The Solution</a></li>
    <li><a href="#the-full-script">The Full Script</a></li>
  </ul>
</nav></div>
                </div><div class="content" id="content"><p>Hello there! Today, let’s unwrap a neat trick for those using Model-Driven Apps within the Dynamics 365 or Power Platform universe. The goal? To effortlessly send email notifications from a record, using a clever bit of JavaScript magic. This could be a game-changer for keeping your team in sync with account updates, without the fuss of manual updates.</p>
<h2 id="why-it-matters">Why It Matters</h2>
<p>In the whirlwind of managing customer accounts, staying ahead with real-time updates is key. Imagine you’ve got a plethora of accounts, each bustling with activity. You’d want your team to get instant notifications about important changes, right? Enter our solution: a straightforward script that triggers an email notification, leveraging the humble yet powerful mailto link.</p>
<h2 id="the-solution">The Solution</h2>
<p>Let’s break down this script, shall we? It’s a journey through fetching crucial data, crafting a message, and finally, launching an email draft in a flash. Here’s how it unfolds:</p>
<p><strong>1. Identifying the Record</strong></p>
<p>First off, we need to know which account record we’re dealing with. This snippet grabs the record’s unique ID straight from the form context. It’s like pinpointing the exact book you need from a vast library.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">entityId</span> <span class="o">=</span> <span class="nx">formContext</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">entity</span><span class="p">.</span><span class="nx">getId</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;{&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
</span></span></code></pre></div><p><strong>2. Fetching Account Details</strong></p>
<p>With the record ID in hand, we’re off to gather some details. This involves making a call to retrieve the account’s information, particularly looking out for the account’s name and the owner’s ID. It’s akin to gathering the ingredients before baking a cake.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="line"><span class="cl"><span class="nx">Xrm</span><span class="p">.</span><span class="nx">WebApi</span><span class="p">.</span><span class="nx">retrieveRecord</span><span class="p">(</span><span class="s2">&#34;account&#34;</span><span class="p">,</span> <span class="nx">entityId</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span> <span class="kd">function</span> <span class="nx">success</span><span class="p">(</span><span class="nx">account</span><span class="p">)</span> <span class="p">{...},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{...}</span> <span class="p">);</span>
</span></span></code></pre></div><p><strong>3. Getting the Owner’s Email</strong></p>
<p>Now, we’ve got the account’s owner ID. The next step? Fetch the email address of this owner from the system user records. This is crucial because it tells us where our email notification is headed.</p>
<p><strong>4. Crafting the Email</strong></p>
<p>Here’s where the creativity kicks in. We piece together the email content, including a direct link to the account record. It’s all about making sure the recipient can jump straight to the details with a single click.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">mailtoLink</span> <span class="o">=</span> <span class="sb">`mailto:?cc=</span><span class="si">${</span><span class="nx">ccEmail</span><span class="si">}</span><span class="sb">&amp;subject=</span><span class="si">${</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">subject</span><span class="p">)</span><span class="si">}</span><span class="sb">&amp;body=</span><span class="si">${</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">mailtoLink</span><span class="p">,</span> <span class="s1">&#39;_blank&#39;</span><span class="p">);</span>
</span></span></code></pre></div><p>This line conjures up an email draft in the default mail client, pre-filled with all the details. It’s like setting the stage for a play, with every actor in place, ready for the curtain to rise.</p>
<h2 id="the-full-script">The Full Script</h2>
<p>After touring through the script, step by step, here’s the entire ensemble, ready to take its place in your Model-Driven App:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">sendEmail</span><span class="p">(</span><span class="nx">primaryControl</span><span class="p">,</span> <span class="nx">UserLcid</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">formContext</span> <span class="o">=</span> <span class="nx">primaryControl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">entityId</span> <span class="o">=</span> <span class="nx">formContext</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">entity</span><span class="p">.</span><span class="nx">getId</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;{&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span> <span class="c1">// Remove curly braces
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> 
</span></span><span class="line"><span class="cl">    <span class="c1">// Retrieve current account record
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">Xrm</span><span class="p">.</span><span class="nx">WebApi</span><span class="p">.</span><span class="nx">retrieveRecord</span><span class="p">(</span><span class="s2">&#34;account&#34;</span><span class="p">,</span> <span class="nx">entityId</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="kd">function</span> <span class="nx">success</span><span class="p">(</span><span class="nx">account</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kd">var</span> <span class="nx">ownerId</span> <span class="o">=</span> <span class="nx">account</span><span class="p">.</span><span class="nx">_ownerid_value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kd">var</span> <span class="nx">accountName</span> <span class="o">=</span> <span class="nx">account</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span> <span class="c1">// Assuming &#39;name&#39; is the field for account&#39;s name
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> 
</span></span><span class="line"><span class="cl">            <span class="c1">// Retrieve current owner&#39;s email address
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">Xrm</span><span class="p">.</span><span class="nx">WebApi</span><span class="p">.</span><span class="nx">retrieveRecord</span><span class="p">(</span><span class="s2">&#34;systemuser&#34;</span><span class="p">,</span> <span class="nx">ownerId</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="kd">function</span> <span class="nx">success</span><span class="p">(</span><span class="nx">systemUser</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kd">var</span> <span class="nx">ccEmail</span> <span class="o">=</span> <span class="nx">systemUser</span><span class="p">.</span><span class="nx">internalemailaddress</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">                    <span class="kd">var</span> <span class="nx">subject</span> <span class="o">=</span> <span class="nx">accountName</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="kd">var</span> <span class="nx">currentHost</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">hostname</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">                    <span class="c1">// Get AppId
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                    <span class="nx">Xrm</span><span class="p">.</span><span class="nx">Utility</span><span class="p">.</span><span class="nx">getGlobalContext</span><span class="p">().</span><span class="nx">getCurrentAppProperties</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                        <span class="kd">function</span> <span class="p">(</span><span class="nx">appProperties</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="kd">var</span> <span class="nx">appId</span> <span class="o">=</span> <span class="nx">appProperties</span><span class="p">.</span><span class="nx">appId</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;App ID: &#34;</span> <span class="o">+</span> <span class="nx">appId</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                            <span class="kd">var</span> <span class="nx">body</span> <span class="o">=</span> <span class="s2">&#34;Hello, I need to contact you about this record: https://&#34;</span> <span class="o">+</span> <span class="nx">currentHost</span> <span class="o">+</span> <span class="s2">&#34;/main.aspx?appid=&#34;</span> <span class="o">+</span> <span class="nx">appId</span> <span class="o">+</span> <span class="s2">&#34;&amp;pagetype=entityrecord&amp;etn=account&amp;id=&#34;</span> <span class="o">+</span> <span class="nx">entityId</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                            <span class="kd">var</span> <span class="nx">mailtoLink</span> <span class="o">=</span> <span class="s2">&#34;mailto:?cc=&#34;</span> <span class="o">+</span> <span class="nx">ccEmail</span> <span class="o">+</span> <span class="s2">&#34;&amp;subject=&#34;</span> <span class="o">+</span> <span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">subject</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;&amp;body=&#34;</span> <span class="o">+</span> <span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">body</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                            <span class="nb">window</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">mailtoLink</span><span class="p">,</span> <span class="s1">&#39;_blank&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;Error retrieving appId: &#34;</span> <span class="o">+</span> <span class="nx">error</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                            <span class="nx">formContext</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">setFormNotification</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                                <span class="s2">&#34;Error retrieving appId: &#34;</span> <span class="o">+</span> <span class="nx">error</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                <span class="s2">&#34;ERROR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                <span class="s2">&#34;001&#34;</span><span class="o">+</span> <span class="nx">error</span><span class="p">.</span><span class="nx">code</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">);</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;Error retrieving owner email address: &#34;</span> <span class="o">+</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">formContext</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">setFormNotification</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;Error retrieving owner email address: &#34;</span> <span class="o">+</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;ERROR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;001&#34;</span><span class="o">+</span> <span class="nx">error</span><span class="p">.</span><span class="nx">code</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">);</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;Error retrieving account: &#34;</span> <span class="o">+</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nx">formContext</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">setFormNotification</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Error retrieving account: &#34;</span> <span class="o">+</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ERROR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;001&#34;</span><span class="o">+</span> <span class="nx">error</span><span class="p">.</span><span class="nx">code</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></div><div class="post-footer" id="post-footer">
    <div class="post-info"><div class="post-info-tag"><span><a href="/tags/http-trigger/">HTTP Trigger</a>
                </span><span><a href="/tags/automation/">Automation</a>
                </span></div><div class="post-info-line"><div class="post-info-mod">
                <span>Updated on 2024-07-05</span>
            </div><div class="post-info-mod"></div>
        </div><div class="post-info-share">
            <span><a href="#" onclick="return false;" title="Share on Twitter" data-sharer="twitter" data-url="http://localhost:1313/posts/custom-mailto-from-command-button/" data-title="Query Parameters on HTTP Trigger" data-via="itweedie" data-hashtags="HTTP Trigger,Automation"><i class="fa-brands fa-square-x-twitter fa-fw"></i></a><a href="#" onclick="return false;" title="Share on Facebook" data-sharer="facebook" data-url="http://localhost:1313/posts/custom-mailto-from-command-button/" data-hashtag="HTTP Trigger"><i class="fa-brands fa-facebook-square fa-fw"></i></a><a href="#" onclick="return false;" title="Share on Linkedin" data-sharer="linkedin" data-url="http://localhost:1313/posts/custom-mailto-from-command-button/"><i class="fa-brands fa-linkedin fa-fw"></i></a><a href="#" onclick="return false;" title="Share on WhatsApp" data-sharer="whatsapp" data-url="http://localhost:1313/posts/custom-mailto-from-command-button/" data-title="Query Parameters on HTTP Trigger" data-web><i class="fa-brands fa-whatsapp fa-fw"></i></a></span>
        </div></div><div class="post-nav"><a href="/posts/query-parameters-on-http-trigger/" class="prev" rel="prev" title="Query Parameters on HTTP Trigger"><i class="fa-solid fa-angle-left fa-fw"></i>Previous Post</a>
            <a href="/posts/pfx-certificate-for-free-for-power-pages/" class="next" rel="next" title="PFX certificate for FREE for Power Pages">Next Post<i class="fa-solid fa-angle-right fa-fw"></i></a></div></div>
</div></article></div>
            </main>
            <footer class="footer"><div class="footer-container"><div class="footer-line">Tech Tweedie Blog</div><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.126.3">Hugo</a> | Theme - <a href="https://github.com/khusika/FeelIt" target="_blank" rel="noopener noreffer" title="FeelIt 1.0.2"><i class="fa-solid fa-hand-holding-heart fa-fw"></i> FeelIt</a>
        </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/"></a></span></div>
</div>
</footer>
        </div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fa-solid fa-chevron-up fa-fw"></i>
            </a></div><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.css"><script src="/lib/lazysizes/lazysizes.min.js"></script><script src="/lib/typeit/typeit.min.js"></script><script src="/lib/lightgallery/lightgallery.min.js"></script><script src="/lib/lightgallery/lg-thumbnail.min.js"></script><script src="/lib/lightgallery/lg-zoom.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script src="/lib/sharer/sharer.min.js"></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"data":{"id-1":"Tech Tweedie","id-2":"Tech Tweedie"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"typeit":{"cursorChar":null,"cursorSpeed":null,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":null,"speed":null}};</script><script src="/js/theme.min.js"></script></body></html>

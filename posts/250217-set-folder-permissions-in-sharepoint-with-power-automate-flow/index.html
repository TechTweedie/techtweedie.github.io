<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Set folder permissions in SharePoint with Power Automate Flow - Tech Tweedie</title><meta name=description content="Beyond the low code, Tech Tweedie offers comprehensive guides and tutorials on Power Platform, Microsoft technologies, and Hugo. Learn how to build PCF controls, install Hugo on Windows 11, and more. Stay updated with our latest posts and in-depth content."><meta property="og:title" content="Set folder permissions in SharePoint with Power Automate Flow">
<meta property="og:description" content="Discover how to set item or folder permissions in SharePoint using Power Automate Flow with a custom connector and service principal in this comprehensive step-by-step guide."><meta property="og:type" content="article"><meta property="og:url" content="https://techtweedie.github.io/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/"><meta property="og:image" content="https://techtweedie.github.io/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/featureImage.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-17T06:00:00+01:00"><meta property="article:modified_time" content="2025-02-17T06:00:00+01:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://techtweedie.github.io/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/featureImage.png"><meta name=twitter:title content="Set folder permissions in SharePoint with Power Automate Flow"><meta name=twitter:description content="Discover how to set item or folder permissions in SharePoint using Power Automate Flow with a custom connector and service principal in this comprehensive step-by-step guide."><meta name=twitter:site content="@itweedie"><meta name=application-name content="Tech Tweedie"><meta name=apple-mobile-web-app-title content="Tech Tweedie"><meta name=theme-color content="#dddddd"><meta name=msapplication-TileColor content="#dddddd"><link rel=icon href=/safari-pinned-tab.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#dddddd><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://techtweedie.github.io/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/><link rel=prev href=https://techtweedie.github.io/posts/240210-send-emails-from-flow-without-a-service-account/><link rel=next href=https://techtweedie.github.io/posts/250325-sppug/><link rel=stylesheet href=/css/page.min.css><link rel=stylesheet href=/css/home.min.css><meta name=google-site-verification content="SJUxP7HXovdJ6V7D8UPJm1ntx_D-yiuiC5XM70mnHCI"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Set folder permissions in SharePoint with Power Automate Flow","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/techtweedie.github.io\/posts\/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow\/"},"image":[{"@type":"ImageObject","url":"https:\/\/techtweedie.github.io\/posts\/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow\/featureImage.png","width":1792,"height":300}],"genre":"posts","keywords":"Power Automate, EntraID, Power Platform","wordcount":2187,"url":"https:\/\/techtweedie.github.io\/posts\/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow\/","datePublished":"2025-02-17T06:00:00+01:00","dateModified":"2025-02-17T06:00:00+01:00","publisher":{"@type":"Organization","name":"itweedie"},"author":{"@type":"Person","name":"itweedie"},"description":"Discover how to set item or folder permissions in SharePoint using Power Automate Flow with a custom connector and service principal in this comprehensive step-by-step guide."}</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//mars.mightora.io/matomo/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","3"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></head><body data-header-desktop=auto data-header-mobile=auto><script>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Tech Tweedie"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/logo-01_150x150.png data-srcset="/logo-01_150x150.png, /logo-01_150x150.png 1.5x, /logo-01_150x150.png 2x" data-sizes=auto alt=/logo-01_150x150.png title=/logo-01_150x150.png><span class=header-title-pre> </span><span id=id-1 class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/categories/community/ title="Supporting the Power Platform Community">Community </a><a class=menu-item href=/categories/how-to/ title="How to">How to </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=https://www.youtube.com/channel/UCy1a2QSDVZNDwZf7KbNmoHQ rel="noopener noreffer" target=_blank>YouTube </a><a class=menu-item href=https://mightora.io/ rel="noopener noreffer" target=_blank>Free Tools </a><span class="menu-item delimiter"></span><a class=menu-item href=/index.xml title=RSS><i class="fa-solid fa-rss fa-fw" title=RSS></i> </a><a href=# onclick=return!1 class="menu-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Tech Tweedie"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/logo-01_150x150.png data-srcset="/logo-01_150x150.png, /logo-01_150x150.png 1.5x, /logo-01_150x150.png 2x" data-sizes=auto alt=/logo-01_150x150.png title=/logo-01_150x150.png><span class=header-title-pre> </span><span id=id-2 class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/categories/community/ title="Supporting the Power Platform Community">Community</a><a class=menu-item href=/categories/how-to/ title="How to">How to</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=https://www.youtube.com/channel/UCy1a2QSDVZNDwZf7KbNmoHQ title rel="noopener noreffer" target=_blank>YouTube</a><a class=menu-item href=https://mightora.io/ title rel="noopener noreffer" target=_blank>Free Tools</a><div class=menu-item><a href=/index.xml title=RSS><i class="fa-solid fa-rss fa-fw" title=RSS></i> </a><span>&nbsp;|&nbsp;</span><a href=# onclick=return!1 class=theme-switch title="Switch Theme">
<i class="fa-solid fa-adjust fa-fw"></i></a></div></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single" data-toc=disable><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/featureImage.png data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/featureImage.png, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/featureImage.png 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/featureImage.png 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/featureImage.png title="Discover how to set item or folder permissions in SharePoint using Power Automate Flow with a custom connector and service principal in this comprehensive step-by-step guide."></div><div class=single-card data-image=true><h2 class="single-title animated flipInX">Set folder permissions in SharePoint with Power Automate Flow</h2><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fa-solid fa-user-circle fa-fw"></i>Author</a></span>&nbsp;<span class=post-category>published in <a href=/categories/how-to/><i class="fa-regular fa-folder fa-fw"></i>How To</a></span></div><div class=post-meta-line><span><i class="fa-regular fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2025-02-17>2025-02-17</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw"></i>&nbsp;2187 words</span>&nbsp;
<span><i class="fa-regular fa-clock fa-fw"></i>&nbsp;11 minutes</span>&nbsp;</div></div><hr><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fa-solid fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#whats-the-problem>Whats the problem</a></li><li><a href=#create-the-app-registration>Create the App Registration</a><ul><li><a href=#step-1---log-in-to-entra>Step 1 - Log in to Entra</a></li><li><a href=#step-2---create-the-app-registration>Step 2 - Create the app registration</a></li><li><a href=#step-3---add-api-permission>Step 3 - Add API permission</a></li><li><a href=#step-4---grant-admin-consent>Step 4 - Grant Admin consent</a></li></ul></li><li><a href=#setting-your-application-permissions-in-sharepoint-online>Setting your application permissions in SharePoint Online</a><ul><li><a href=#step-1---get-sharepoint-site-id>Step 1 - Get SharePoint Site ID</a></li><li><a href=#step-2---give-permission-to-our-app-registration-for-this-site>Step 2 - Give Permission to our App Registration for this site</a></li><li><a href=#step-1---access-ms-graph-explorer>Step 1 - Access MS Graph Explorer</a></li><li><a href=#step-2---set-permissions>Step 2 - Set permissions</a></li></ul></li><li><a href=#download-and-testing-the-connector>Download and testing the connector</a><ul><li><a href=#step-1---find-custom-connectors>Step 1 - Find custom connectors</a></li><li><a href=#step-2---create-a-new-connector>Step 2 - Create a new connector</a></li><li><a href=#step-3---configure-your-connector>Step 3 - Configure your connector</a></li><li><a href=#step-5---add-your-first-connection>Step 5 - Add your first connection</a></li><li><a href=#step-6---test-get-site-information>Step 6 - Test get site information</a></li></ul></li><li><a href=#testing-adding-a-permission>Testing adding a permission</a><ul><li><a href=#step-1---test-2-to-list-drives>Step 1 - Test 2 to list drives</a></li><li><a href=#step-2---lets-test-adding-a-folder>Step 2 - Let&rsquo;s test adding a folder</a></li><li><a href=#step-3---lets-add-the-permission>Step 3 - Let&rsquo;s add the permission</a></li><li><a href=#step-4---lets-try-it-in-a-flow>Step 4 - Lets try it in a Flow</a></li></ul></li><li><a href=#lets-demo-in-a-power-automate-flow>Lets Demo in a Power Automate Flow</a><ul><li><a href=#step-1---start-with-a-flow-to-list-the-drives>Step 1 - Start with a flow to list the drives</a></li><li><a href=#step-2---filter-the-drives-we-got-back>Step 2 - Filter the drives we got back</a></li><li><a href=#step-3---lets-test-adding-a-folder>Step 3 - Let&rsquo;s test adding a folder</a></li><li><a href=#step-4---lets-add-the-permission>Step 4 - Let&rsquo;s add the permission</a></li><li><a href=#conclusion>Conclusion</a></li></ul></li></ul></nav></div></div><div class=content id=content><p>Want to grand and remove item or folder permissions in SharePoint using <strong>Power Automate</strong> with a Service Principle but can&rsquo;t do it? Not able to do it with the out of the box SharePoint Connector?</p><p>Tired of dealing with Conditional Access Policies, password expirations, and frequent logins?</p><p>Good news! In this guide, I&rsquo;ll show you how to set these using an App Registration. No service accounts, no password headaches. I&rsquo;ll also share a Custom Connector to make it even easier, plus step-by-step instructions to:</p><ul><li>Create and configure the App Registration</li><li>Assign API permissions</li><li>Setting permissions using sites.selected</li><li>Use Power Automate with the custom connector</li></ul><div class=video><iframe src=https://www.youtube.com/embed/NhQvZ6dcpvg allow=fullscreen title="YouTube Video"></iframe></div><h2 id=whats-the-problem>Whats the problem</h2><p>Let&rsquo;s have a look at the problem we are trying to solve. We are going to go into Power Automate Flow and see if we can edit, add, or remove a SharePoint Permission using the <a href=https://learn.microsoft.com/en-us/connectors/sharepointonline/ target=_blank rel="noopener noreffer">Standard SharePoint Connector</a>.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=msedge_l29tV1NhHD.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_l29tV1NhHD.gif, msedge_l29tV1NhHD.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_l29tV1NhHD.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_l29tV1NhHD.gif title="alt text"></p><p>As we can see it is not possible.</p><p>To solve this problem I am going to share with you a connector I have written and released that is free to use, and show you how to set it up and use it.</p><h2 id=create-the-app-registration>Create the App Registration</h2><p>For this section you will need the help of a Global Administrator</p><h3 id=step-1---log-in-to-entra>Step 1 - Log in to Entra</h3><p>By default most users will have the ability to go to <a href=https://entra.microsoft.com target=_blank rel="noopener noreffer">https://entra.microsoft.com</a>
and log in with your user account.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=brave_yym6HjxqsT.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/brave_yym6HjxqsT.gif, brave_yym6HjxqsT.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/brave_yym6HjxqsT.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/brave_yym6HjxqsT.gif title="alt text"></p><h3 id=step-2---create-the-app-registration>Step 2 - Create the app registration</h3><p>Next we are going to create an application registration so our Power Automate flow can talk directly to SharePoint Online.</p><ol><li>When you are on the Entra Overview page, open up <strong>Identity</strong>.</li><li>Then navigate to <strong>Applications</strong> in the left hand menu and then open up <strong>App Registrations</strong>.</li><li>From there select <strong>New Registration</strong>.</li><li>A new screen will open, give your new app registration a name and then click next.</li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=brave_AEQxFOEbOc-B.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/brave_AEQxFOEbOc-B.gif, brave_AEQxFOEbOc-B.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/brave_AEQxFOEbOc-B.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/brave_AEQxFOEbOc-B.gif title="alt text"></p><h3 id=step-3---add-api-permission>Step 3 - Add API permission</h3><p>We then need to give our App Registration an API Permission, This will be the permission used to talk to Exchange Online.</p><ol><li>In the left hand menu click on <strong>API Permission</strong>.</li><li>Click on <strong>Add permission</strong>.</li><li>A window will then open, select <strong>Application Permission</strong>.</li><li>Then using the search box type in <code>sites.selected</code>.</li><li>The list will then filter, as it does open up the <strong>Mail</strong> option and select <code>sites.selected</code>.</li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=brave_9744WEVLUO-B.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/brave_9744WEVLUO-B.gif, brave_9744WEVLUO-B.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/brave_9744WEVLUO-B.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/brave_9744WEVLUO-B.gif title="alt text"></p><h3 id=step-4---grant-admin-consent>Step 4 - Grant Admin consent</h3><ol><li><p>If the Grant admin consent is grayed out then this is because we lack administrative roles for our account. For this next step you will need a some help from a Global Admin.</p></li><li><p>Ask a Global administrator to grant admin consent for you if you cant do it.</p></li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=brave_wlJHahJXVv.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/brave_wlJHahJXVv.gif, brave_wlJHahJXVv.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/brave_wlJHahJXVv.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/brave_wlJHahJXVv.gif title="alt text"></p><h2 id=setting-your-application-permissions-in-sharepoint-online>Setting your application permissions in SharePoint Online</h2><p>Our next step is to set what permissions the application has within SharePoint. This is different to Exchange where you are limiting the default permission, with <code>sites.selected</code> we have to explicitly give permission rather than specifically limiting it.
This Stage will need to be done by someone who is an Owner of the SharePoint site using Microsoft Graph.</p><blockquote><p><strong>Further reading:</strong> Further information on the API call can be found <a href="https://learn.microsoft.com/en-us/graph/api/site-post-permissions?view=graph-rest-1.0&amp;tabs=http" target=_blank rel="noopener noreffer">here</a>.</p></blockquote><h3 id=step-1---get-sharepoint-site-id>Step 1 - Get SharePoint Site ID</h3><p>Navigate to your SharePoint Site, e.g. <code>https://tweedtech.sharepoint.com/sites/TechTweedieDemoSite1</code> and then just add <code>/_api/site?$select=Id</code> on the end.</p><p>For example this would give you the URL <code>https://tweedtech.sharepoint.com/sites/TechTweedieDemoSite1/_api/site?$select=Id</code>.</p><p>You will get XML back that looks like this</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;entry</span> <span class=na>xml:base=</span><span class=s>&#34;https://tweedtech.sharepoint.com/sites/TechTweedieDemoSite1/_api/&#34;</span> <span class=na>xmlns=</span><span class=s>&#34;http://www.w3.org/2005/Atom&#34;</span> <span class=na>xmlns:d=</span><span class=s>&#34;http://schemas.microsoft.com/ado/2007/08/dataservices&#34;</span> <span class=na>xmlns:m=</span><span class=s>&#34;http://schemas.microsoft.com/ado/2007/08/dataservices/metadata&#34;</span> <span class=na>xmlns:georss=</span><span class=s>&#34;http://www.georss.org/georss&#34;</span> <span class=na>xmlns:gml=</span><span class=s>&#34;http://www.opengis.net/gml&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;id&gt;</span>https://tweedtech.sharepoint.com/sites/TechTweedieDemoSite1/_api/site<span class=nt>&lt;/id&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;category</span> <span class=na>term=</span><span class=s>&#34;SP.Site&#34;</span> <span class=na>scheme=</span><span class=s>&#34;http://schemas.microsoft.com/ado/2007/08/dataservices/scheme&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;link</span> <span class=na>rel=</span><span class=s>&#34;edit&#34;</span> <span class=na>href=</span><span class=s>&#34;site&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;title</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;updated&gt;</span>2025-02-13T21:53:24Z<span class=nt>&lt;/updated&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;author&gt;</span>
</span></span><span class=line><span class=cl>       <span class=nt>&lt;name</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/author&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;content</span> <span class=na>type=</span><span class=s>&#34;application/xml&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>       <span class=nt>&lt;m:properties&gt;</span>
</span></span><span class=line><span class=cl>           <span class=nt>&lt;d:Id</span> <span class=na>m:type=</span><span class=s>&#34;Edm.Guid&#34;</span><span class=nt>&gt;</span>9ce4e8e2-fa87-474b-bd2f-d858d828f8a1<span class=nt>&lt;/d:Id&gt;</span>
</span></span><span class=line><span class=cl>       <span class=nt>&lt;/m:properties&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/content&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/entry&gt;</span>
</span></span></code></pre></div><p>Locate the ID value, it will look something like this from within the xml</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;d:Id</span> <span class=na>m:type=</span><span class=s>&#34;Edm.Guid&#34;</span><span class=nt>&gt;</span>9ce4e8e2-fa87-474b-bd2f-d858d828f8a1<span class=nt>&lt;/d:Id&gt;</span>
</span></span></code></pre></div><p>We need the Site ID value which in this example is <code>9ce4e8e2-fa87-474b-bd2f-d858d828f8a1</code></p><p><img class=lazyload src=/svg/loading.min.svg data-src=brave_vD8h1UHpbG.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/brave_vD8h1UHpbG.gif, brave_vD8h1UHpbG.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/brave_vD8h1UHpbG.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/brave_vD8h1UHpbG.gif title="alt text"></p><h3 id=step-2---give-permission-to-our-app-registration-for-this-site>Step 2 - Give Permission to our App Registration for this site</h3><p>The first stage is to give the permission to our app permissions on the SharePoint site, to do this we need to use Graph Explorer. You will also need to be an Owner of the SharePoint Site you are giving permissions to.</p><h3 id=step-1---access-ms-graph-explorer>Step 1 - Access MS Graph Explorer</h3><ol><li>Go to <a href=https://developer.microsoft.com/en-us/graph/graph-explorer target=_blank rel="noopener noreffer">https://developer.microsoft.com/en-us/graph/graph-explorer</a></li><li>Sign in to your account.</li><li>Make sure the Tenant shows your tenant or company name.</li><li>Then Press <strong>Run query</strong> to make sure you are connected.</li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=msedge_QUHtmixvFm-B.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_QUHtmixvFm-B.gif, msedge_QUHtmixvFm-B.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_QUHtmixvFm-B.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_QUHtmixvFm-B.gif title="alt text"></p><h3 id=step-2---set-permissions>Step 2 - Set permissions</h3><p>The next stage is to run the <strong>Create permission</strong> command for the app registration to give tit the necessary permissions to be able to set permissions for files and folders.</p><p>To do this we need to;</p><ol><li><p>Change the method to <code>POST</code>.</p></li><li><p>Enter in the following address <code>https://graph.microsoft.com/v1.0/sites/{sitesId}/permissions</code>, replacing the <code>{siteID}</code> with your <strong>siteID</strong>. e.g. <code>https://graph.microsoft.com/v1.0/sites/9ce4e8e2-fa87-474b-bd2f-d858d828f8a1/permissions</code>.</p></li><li><p>Click on <strong>Modify permissions</strong> and open the <strong>permissions panel</strong>.</p></li><li><p>Search for site, and then open up <strong>Sites</strong>.</p></li><li><p>Click on <strong>Consent</strong> for <code>Sites.FullControl.All</code>. This will open up a consent screen.</p></li><li><p>Then in <strong>Request body</strong> enter in the below json replacing <code>{clientID}</code> and <code>{displayName}</code> with your applications details.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span> 
</span></span><span class=line><span class=cl><span class=nt>&#34;roles&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;write&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=nt>&#34;grantedToIdentities&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;application&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;{clientID}&#34;</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>      <span class=nt>&#34;displayName&#34;</span><span class=p>:</span> <span class=s2>&#34;{displayName}&#34;</span> 
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>e.g.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span> 
</span></span><span class=line><span class=cl><span class=nt>&#34;roles&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;write&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=nt>&#34;grantedToIdentities&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;application&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;229df885-246d-4b6f-8280-267e51f9dc65&#34;</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>      <span class=nt>&#34;displayName&#34;</span><span class=p>:</span> <span class=s2>&#34;SharePoint - Demo1 - PowerAutomate&#34;</span> 
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li><li><p>You will then get the response like the below</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;@odata.context&#34;</span><span class=p>:</span> <span class=s2>&#34;https://graph.microsoft.com/v1.0/$metadata#sites(&#39;9ce4e8e2-fa87-474b-bd2f-d858d828f8a1&#39;)/permissions/$entity&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;aTowaS50fG1zLnNwLmV4dHwyMjlkZjg4NS0yNDZkLTRiNmYtODI4MC0yNjdlNTFmOWRjNjVANjM3NTlkOWYtYmZjYS00ZjUyLWFlOTgtOGYyZjFkN2JjMTcz&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;grantedToIdentitiesV2&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;application&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;displayName&#34;</span><span class=p>:</span> <span class=s2>&#34;SharePoint - Demo1 - PowerAutomate&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;229df885-246d-4b6f-8280-267e51f9dc65&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;grantedToIdentities&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;application&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;displayName&#34;</span><span class=p>:</span> <span class=s2>&#34;SharePoint - Demo1 - PowerAutomate&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;229df885-246d-4b6f-8280-267e51f9dc65&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=msedge_eb1IgNQwCG-B.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_eb1IgNQwCG-B.gif, msedge_eb1IgNQwCG-B.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_eb1IgNQwCG-B.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_eb1IgNQwCG-B.gif title="alt text"></p><h2 id=download-and-testing-the-connector>Download and testing the connector</h2><h3 id=step-1---find-custom-connectors>Step 1 - Find custom connectors</h3><p>First we need to find custom connectors in Power Automate.</p><p>To do this we need to:</p><ol><li>Navigate to <code>https://make.powerautomate.com/</code></li><li>Change our environment should you need to.</li><li>Then in the left hand menu, navigate to <strong>More</strong> and then <strong>Discover all</strong>, and then locate <strong>Custom connectors</strong>.</li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=../send-emails-from-flow-without-a-service-account/msedge_eb1IgNQwCG.gif data-srcset="../send-emails-from-flow-without-a-service-account/msedge_eb1IgNQwCG.gif, ../send-emails-from-flow-without-a-service-account/msedge_eb1IgNQwCG.gif 1.5x, ../send-emails-from-flow-without-a-service-account/msedge_eb1IgNQwCG.gif 2x" data-sizes=auto alt=../send-emails-from-flow-without-a-service-account/msedge_eb1IgNQwCG.gif title="alt text"></p><h3 id=step-2---create-a-new-connector>Step 2 - Create a new connector</h3><ol><li>Click on <strong>New custom connector</strong>.</li><li>Then click on <strong>Import an OpenAPI from URL</strong>.</li><li>Then enter in the connector name <code>SharePoint with Graph</code>.</li><li>Then enter in the URL <code>https://raw.githubusercontent.com/itweedie/PowerPlatform-PowerAutomate-SharePoint-with-Graph-Connector/refs/heads/main/connector/shared_sharepoint-20with-20graph-5fbb1338f75d4745cb-5f8d99aea54e2a1a34/apiDefinition.swagger.json</code></li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=msedge_DKVu1bRAbA.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_DKVu1bRAbA.gif, msedge_DKVu1bRAbA.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_DKVu1bRAbA.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_DKVu1bRAbA.gif title="alt text"></p><h3 id=step-3---configure-your-connector>Step 3 - Configure your connector</h3><ol><li>Click on to the Security tab.</li><li>Make sure we are using <strong>OAuth 2.0</strong></li><li>Make sure the Identity Provider is set to <strong>Azure Active Directory</strong> and that <strong>Enable Service Principle support</strong> is ticked.</li><li>Click in to <strong>Client ID</strong></li><li>Navigate back to Entra and locate your App Registration.</li><li>Copy the <strong>Client ID</strong> and paste it in to the <strong>Client ID</strong> box on the Custom Connector.</li><li>Go back to the App Registration in Entra, and click on <strong>Certificates & secrets</strong>, then click on <strong>New client secret</strong>. Choose a name and a reasonable date for expiry that fits within your organisations policy&rsquo;s.</li><li>Copy the <strong>Secret value</strong>, NOT Secret ID, and paste it in to your connector. You will need your secret ID one more time so keep the Entra page open with it on.</li><li>Enter in <strong>Resource URL</strong> as <code>https://graph.microsoft.com</code>.</li><li>Click Create</li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=msedge_dG8NYitBjs.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_dG8NYitBjs.gif, msedge_dG8NYitBjs.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_dG8NYitBjs.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_dG8NYitBjs.gif title="alt text"></p><h3 id=step-5---add-your-first-connection>Step 5 - Add your first connection</h3><ol><li>Click on to Test.</li><li>Then click on to <strong>New connection</strong>.</li><li>You should then get a screen which lets your choose <strong>Service Principle</strong>, if you don&rsquo;t repeat step 3.</li><li>Then click <strong>Create Connection</strong>.</li><li>Enter in your <strong>Secret</strong> (we do this first as we already have the page open from Step 3).</li><li>Then enter in your <strong>Client ID</strong> and <strong>Tenant ID</strong>.</li><li>Then click <strong>Create Connection</strong>.</li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=msedge_DfsnensC8A.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_DfsnensC8A.gif, msedge_DfsnensC8A.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_DfsnensC8A.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_DfsnensC8A.gif title="alt text"></p><h3 id=step-6---test-get-site-information>Step 6 - Test get site information</h3><p>Lets see if we can connect to our SharePoint Site using out app registration.</p><ol><li>On the <strong>Test</strong> tab click on <strong>SiteInfomation</strong>.</li><li>Enter in the details from your site URL. For our demo we are using <code>https://tweedtech.sharepoint.com/sites/TechTweedieDemoSite1/</code>.<ol><li>We will enter in the <strong>tenantPrefix</strong>, for us this is <code>tweedtech</code>.</li><li>For site name we will enter in <code>TechTweedieDemoSite1</code> from the url of our site.</li><li>For site path we can see from the URL this is <code>sites</code>.</li></ol></li><li>Click on <strong>Test operation</strong> to see if it works.</li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=msedge_CAWOIgbnG0.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_CAWOIgbnG0.gif, msedge_CAWOIgbnG0.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_CAWOIgbnG0.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_CAWOIgbnG0.gif title="alt text"></p><h2 id=testing-adding-a-permission>Testing adding a permission</h2><p>You can skip this part if you would like, and go to the next section.</p><h3 id=step-1---test-2-to-list-drives>Step 1 - Test 2 to list drives</h3><p>We are going to test the ability to list site drives. The site drives are the document libraries contained within a SharePoint Site, and we will need the drive ID to set permissions later.</p><p>Enter in your site id, for us this is <code>9ce4e8e2-fa87-474b-bd2f-d858d828f8a1</code> and we will get our Drive ID back which for us is <code>b!4ujknIf6S0e9L9hY2Cj4oSy8fRwGRJ9Ghv-lEfn4u6ovHPyydePwRosMG0M4nhQc</code>.</p><p>We can do this in Power Automate Flow later or save it as an environment variable, or hard code it depending on how we want to use it.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=msedge_GEOo9Hue9I.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_GEOo9Hue9I.gif, msedge_GEOo9Hue9I.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_GEOo9Hue9I.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_GEOo9Hue9I.gif title="alt text"></p><h3 id=step-2---lets-test-adding-a-folder>Step 2 - Let&rsquo;s test adding a folder</h3><p>So we have something to give permission for.</p><p>To do this lets;</p><ol><li>Click on the AddFolder action.</li><li>Enter in <strong>siteID</strong>, for us this is <code>9ce4e8e2-fa87-474b-bd2f-d858d828f8a1</code>.</li><li>Let&rsquo;s enter in our <strong>driveID</strong> which is <code>b!4ujknIf6S0e9L9hY2Cj4oSy8fRwGRJ9Ghv-lEfn4u6ovHPyydePwRosMG0M4nhQc</code>.</li><li>Then lets give our folder a name, we have to enter this twice.</li><li>We have got the response back and as part of the response we have an item ID <code>01LDPBINVTIMOY4Y3TGRDIDMVHU4F3HIZM</code>.</li><li>We will need the <strong>item ID</strong> to set the permissions against.</li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=msedge_EatvSjsgJL.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_EatvSjsgJL.gif, msedge_EatvSjsgJL.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_EatvSjsgJL.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_EatvSjsgJL.gif title="alt text"></p><h3 id=step-3---lets-add-the-permission>Step 3 - Let&rsquo;s add the permission</h3><p>We are now able to test adding the permission.</p><ol><li>Click on to <strong>AddItemPermission</strong>.</li><li>Enter in <strong>siteID</strong>, for us this is <code>9ce4e8e2-fa87-474b-bd2f-d858d828f8a1</code>.</li><li>Let&rsquo;s enter in our <strong>driveID</strong> which is <code>b!4ujknIf6S0e9L9hY2Cj4oSy8fRwGRJ9Ghv-lEfn4u6ovHPyydePwRosMG0M4nhQc</code>.</li><li>Then our <strong>itemID</strong> which we have as <code>01LDPBINVTIMOY4Y3TGRDIDMVHU4F3HIZM</code>.</li><li>Then we need add in a <strong>message</strong>. We are going to put in <code>Test Message</code>.</li><li>We are going to set <strong>RequireSignIn</strong> to <code>true</code>.</li><li>We are going to set <strong>sendInvitation</strong> to <code>true</code>.</li><li>The email of the user we are going to invite is <code>demo@tweed.technology</code>.</li><li>Add the permission we are going to give them is <code>read</code>.</li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=msedge_60GqVOBkhm.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_60GqVOBkhm.gif, msedge_60GqVOBkhm.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_60GqVOBkhm.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_60GqVOBkhm.gif title="alt text"></p><p>We can also see we got this through as an email message to.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=msedge_Obo6v9AKO2.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_Obo6v9AKO2.gif, msedge_Obo6v9AKO2.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_Obo6v9AKO2.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_Obo6v9AKO2.gif title="alt text"></p><h3 id=step-4---lets-try-it-in-a-flow>Step 4 - Lets try it in a Flow</h3><ol><li>Click on <strong>My flows</strong></li><li>Create a new flow.</li><li>Add a trigger.</li><li>Add a new step.</li><li>From Connector type choose Custom.</li><li>Then select <strong>SharePoint with Graph</strong> from the list.</li><li>Enter in <strong>siteID</strong>, for us this is <code>9ce4e8e2-fa87-474b-bd2f-d858d828f8a1</code>.</li><li>Let&rsquo;s enter in our <strong>driveID</strong> which is <code>b!4ujknIf6S0e9L9hY2Cj4oSy8fRwGRJ9Ghv-lEfn4u6ovHPyydePwRosMG0M4nhQc</code>.</li><li>Then our <strong>itemID</strong> which we have as <code>01LDPBINVTIMOY4Y3TGRDIDMVHU4F3HIZM</code>.</li><li>Then we need add in a <strong>message</strong>. We are going to put in <code>Test Message</code>.</li><li>We are going to set <strong>RequireSignIn</strong> to <code>true</code>.</li><li>We are going to set <strong>sendInvitation</strong> to <code>true</code>.</li><li>The email of the user we are going to invite is <code>demo@tweed.technology</code>.</li><li>Add the permission we are going to give them is <code>write</code>.</li><li>Test and make sure the email comes through.</li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=msedge_wc9jAaR4Kl.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_wc9jAaR4Kl.gif, msedge_wc9jAaR4Kl.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_wc9jAaR4Kl.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_wc9jAaR4Kl.gif title="alt text"></p><p>We can we have got an email through so our user is aware they have been given access to this folder.
<img class=lazyload src=/svg/loading.min.svg data-src=msedge_64t2sZ5acO.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_64t2sZ5acO.gif, msedge_64t2sZ5acO.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_64t2sZ5acO.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_64t2sZ5acO.gif title="alt text"></p><h2 id=lets-demo-in-a-power-automate-flow>Lets Demo in a Power Automate Flow</h2><p>Let&rsquo;s demo is in Power Automate flow, so we can set the permissions for a folder we will create.</p><h3 id=step-1---start-with-a-flow-to-list-the-drives>Step 1 - Start with a flow to list the drives</h3><p>First we need to List the Drives in our site so we can find the right one.</p><ol><li>Add a new step.</li><li>From Connector type choose Custom.</li><li>Then select <strong>SharePoint with Graph</strong> from the list.</li><li>Enter in <strong>siteID</strong>, for us this is <code>9ce4e8e2-fa87-474b-bd2f-d858d828f8a1</code>.</li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=msedge_lt6JMFEcdS.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_lt6JMFEcdS.gif, msedge_lt6JMFEcdS.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_lt6JMFEcdS.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_lt6JMFEcdS.gif title="alt text"></p><h3 id=step-2---filter-the-drives-we-got-back>Step 2 - Filter the drives we got back</h3><p>Our next step is to filter the array of drive&rsquo;s we got back.</p><ol><li>Add a new step</li><li>Search for <code>filter</code>.</li><li>Click on the data operation filter action.</li><li>Then add the following details;<ol><li>In from select <code>value</code> from the <strong>Site Drves</strong> step.</li><li>In the <strong>Choose value box</strong> select <code>name</code> from the <strong>Site Drves</strong> step.</li><li>Enter the name of your document library in our example this is a library called <code>test</code>.</li></ol></li><li>Let&rsquo;s test it.</li><li>What we get back in outputs are the details for the document library which we will use in our next step.</li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=msedge_zbj491YsXs.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_zbj491YsXs.gif, msedge_zbj491YsXs.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_zbj491YsXs.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_zbj491YsXs.gif title="alt text"></p><h3 id=step-3---lets-test-adding-a-folder>Step 3 - Let&rsquo;s test adding a folder</h3><p>So we have something to give permission for.</p><p>To do this lets;</p><ol><li>Add a new step.</li><li>From Connector type choose Custom.</li><li>Then select <strong>SharePoint with Graph</strong> from the list.</li><li>Click on the <strong>Add Folder</strong> action.</li><li>Enter in <strong>siteID</strong>, for us this is <code>9ce4e8e2-fa87-474b-bd2f-d858d828f8a1</code>.</li><li>In the <strong>Drive ID</strong> add in the <code>id</code> from the filter action.</li><li>Then lets give our folder a name, we have to enter this twice.</li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=msedge_hSDlZxe458.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_hSDlZxe458.gif, msedge_hSDlZxe458.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_hSDlZxe458.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_hSDlZxe458.gif title="alt text"></p><h3 id=step-4---lets-add-the-permission>Step 4 - Let&rsquo;s add the permission</h3><p>We are now able to test adding the permission.</p><ol><li>Add a new step.</li><li>From Connector type choose Custom.</li><li>Then select <strong>SharePoint with Graph</strong> from the list.</li><li>Click on to <strong>Add Item Permission</strong>.</li><li>Enter in <strong>siteID</strong>, for us this is <code>9ce4e8e2-fa87-474b-bd2f-d858d828f8a1</code>.</li><li>Let&rsquo;s select our <strong>drive ID</strong> add in the <code>id</code> from the filter action.</li><li>Let&rsquo;s select our <strong>item ID</strong> add in the <code>id</code> from the <strong>Add Folder</strong> action.</li><li>Then we need add in a <strong>message</strong>. We are going to put in <code>Test Message</code>.</li><li>We are going to set <strong>Require Sign In</strong> to <code>Yes</code>.</li><li>We are going to set <strong>Send Invitation</strong> to <code>Yes</code>.</li><li>The email of the user we are going to invite is <code>demo@tweed.technology</code>.</li><li>Add the permission we are going to give them is <code>write</code>.</li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=msedge_c16ZsTtjEA.gif data-srcset="/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_c16ZsTtjEA.gif, msedge_c16ZsTtjEA.gif 1.5x, /posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_c16ZsTtjEA.gif 2x" data-sizes=auto alt=/posts/250217-set-folder-permissions-in-sharepoint-with-power-automate-flow/msedge_c16ZsTtjEA.gif title="alt text"></p><h3 id=conclusion>Conclusion</h3><p>Congratulations! You have successfully set folder permissions in SharePoint using Power Automate Flow. By following these steps, you can streamline your workflow and ensure that the right people have the appropriate access to your SharePoint folders. This process not only saves time but also enhances the security and management of your documents. Keep exploring the capabilities of Power Automate to further optimize your SharePoint experience. Happy automating!</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-tag><span><a href=/tags/power-automate/>Power Automate</a>
</span><span><a href=/tags/entraid/>EntraID</a>
</span><span><a href=/tags/power-platform/>Power Platform</a></span></div><div class=post-info-line><div class=post-info-mod><span>Updated on 2025-02-17</span></div><div class=post-info-mod></div></div><div class=post-info-share><span></span></div></div><div class=post-nav><a href=/posts/240210-send-emails-from-flow-without-a-service-account/ class=prev rel=prev title="Send Emails from Flow without a Service Account"><i class="fa-solid fa-angle-left fa-fw"></i>Previous Post</a>
<a href=/posts/250325-sppug/ class=next rel=next title="At the Scottish Power Platform User Group: Enabling Low-Code Developers to Create Custom Client Reports with a Helping Hand from Azure – Scottish Power Platform User Group">Next Post<i class="fa-solid fa-angle-right fa-fw"></i></a></div></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Tech Tweedie Blog</div><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.124.1">Hugo</a> | Theme - <a href=https://github.com/khusika/FeelIt target=_blank rel="noopener noreffer" title="FeelIt <nil>"><i class="fa-solid fa-hand-holding-heart fa-fw"></i> FeelIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw"></i><span itemprop=copyrightYear>2019 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/></a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fa-solid fa-chevron-up fa-fw"></i></a></div><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script src=/lib/lazysizes/lazysizes.min.js></script><script src=/lib/typeit/typeit.min.js></script><script src=/lib/clipboard/clipboard.min.js></script><script>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{},data:{"id-1":"Tech Tweedie","id-2":"Tech Tweedie"},typeit:{cursorChar:null,cursorSpeed:null,data:{"id-1":["id-1"],"id-2":["id-2"]},duration:null,speed:null}}</script><script src=/js/theme.min.js></script></body></html>